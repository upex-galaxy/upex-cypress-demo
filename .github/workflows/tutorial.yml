#!ESTE ARCHIVO ES UN TUTORIAL, NO CAMBIARLO EN ABSOLUTO. 
#! Si Quieres crear tu propio archivo YML, usa el sanityTemplate.yml para copiar y pegar en tu propio archivo yml...
#! Para crear tu propio archivo yml, usa tu nombre como SUFIJO del nombre del archivo; ejemplo: sanity-ely.yml
name: ğŸ§ªExample Test in CI Pipeline with Cypress
run-name: ${{github.actor}}ğŸ‘¨ğŸ»â€ğŸ”¬ triggered Test in ${{github.ref_name}}

# on:
#     push:
#         branches-ignore: [main, QA]
#*Esto indica que se ejecutarÃ¡ con PUSH o MERGE en cualquier rama que no sea 'main' ni 'QA'

on: [workflow_dispatch] #Esta opciÃ³n es para este Tutorial, para que no se ejecute en CI.

jobs:
  #* Este es un Nombre de este Job, puedes dejarlo como estÃ¡.
  TestSuite:
    #* Este parÃ¡metro indica que se correrÃ¡ en un Sistema Operativo. No cambiar.
    runs-on: ubuntu-latest

    #todo: AquÃ­ a continuaciÃ³n vamos a definir quÃ© vamos a correr de Postman:
    steps:
    #* Este paso, copia y pega literalmente el repo que tenemos.
    - name: ğŸ“˜Checkout Repo
      uses: actions/checkout@v3
      #* el Name es opcional, e indica el nombre del Step. Uses es la dependencia.

    - name: ğŸ“¦Set up Node.js
      uses: actions/setup-node@v2
      with:
        node-version: 16
        #* El with se usa para indicar quÃ© parÃ¡metro se usa con la dependencia.
        #* Considera que el with dependerÃ¡ del uso de la dependencia.

    - name: ğŸ’¾Installing Dependencies
      run: |
        npm ci
        npm list
      #* El CI en npm es buena prÃ¡ctica para instalar dependencias en lugar de npm i, y list es para listar y verlas.

      #* Esta dependencia de CI es exclusiva de Cypress que nos permite ejecutar sin necesidad de hacer el build.
      #! AQUÃ DEBES MODIFICAR el Test Suite a ejecutar.
      #todo: Agrega el tu path de archivo cypress en el npm run file:
    - name: ğŸ§ªCypress Run Test Coverage in Chrome
      uses: cypress-io/github-action@v4
      with:
        browser: chrome
        command: | #EDITAR AQUÃ EL ARCHIVO SUITE A EJECUTAR:
          npm run file cypress/e2e/Tests/Elements/GX-10497-Buttons.cy.js

    #* Esto es para guardar el reporte previamente generado y colocarlo en Github.
    - name: ğŸ“ŠUpload Artifact â˜•Mochawesome HTML Report
      if: always()
      uses: actions/upload-artifact@v3
      with:
        name: mochaTest-report
        path: mochawesome-report
    #* if: always() es un comando YML condicional: Si pasa o no el paso anterior, corre este Paso.

    # #todo: IMPORTING JIRA...
    # - name: âœ…Import Test Results to Xray
    #   if: always()
    #   uses: mikepenz/xray-action@v2
    #   with: #! EDITAR AQUÃ EL TEST EXECUTION (TX) DE JIRA DONDE SE CARGARÃN LOS TESTS:
    #       username: ${{secrets.XRAY_CLIENT_ID}}
    #       password: ${{secrets.XRAY_CLIENT_SECRET}}
    #       testFormat: 'junit'
    #       testPaths: 'reports/test-results.xml'
    #       #todo: CAMBIA el TX por tu propio TX de tu tarea.
    #       testExecKey: 'GX-1'
    #       #todo: CAMBIA el ID del Proyecto del que pertenece tu tarea.
    #       projectKey: 'GX'
